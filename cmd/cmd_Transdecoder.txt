# Run Transdecoder LongOrfs
perl TransDecoder-TransDecoder-v5.7.1/TransDecoder.LongOrfs -t scisoseq.mapped_transcripts.collapse.fasta &> TransEncoderlog &


## downloaded Uniprot canonical+isoform Human protein fasta files on 16th November 2023
# make db
makeblastdb -in uniprotkb_Human_AND_model_organism_9606_2023_11_16.fasta -dbtype prot &

# run hmmsearch
~/tools/hmmer-3.4/bin/hmmsearch --cpu 8 -E 1e-10 --domtblout pfam.domtblout ~/databases/Pfam/Pfam-A.hmm longest_orfs.pep &> hmmerLog &

# run blastp on longest_orfs.pep by using the db from UniProt
blastp -query longest_orfs.pep -db uniprotkb_Human_AND_model_organism_9606_2023_11_16.fasta -max_target_seqs 1 -outfmt 6 -evalue 1e-5 -num_threads 10 > blast.outfmt6 &> blastplog &

## run Transdecoder Predict
perl TransDecoder-TransDecoder-v5.7.1/TransDecoder.Predict -t scisoseq.mapped_transcripts.collapse.fasta --retain_pfam_hits scisoseq.5p--3p.tagged.refined.corrected.sorted.dedup.fasta.transdecoder_dir/pfam.domtblout &> TransdecoderPredict.Log &